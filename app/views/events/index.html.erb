<h1>All Events</h1>

<input type="text" name="myInput" id="myInput" placeholder="Search for event.." class = "form-control">


<% content_for :js do %>
	<script> 
		$(document).ready(function(){
  			$("#myInput").on("keyup", function() {
    			var value = $(this).val().toLowerCase();
    			$("#myTable tr").filter(function() {
      				$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    			});
  			});
		});
		
	</script>

<% end %>

<script>
	$(document).ready(function() {
		$('#myInput').keyUp(function() {
			search_table($(this).val());
		}
		function search_table(value) {
			$('#myTable tr').each(function() {
				var found = 'false';
				$(this).each(function() {
					if ($(this).text().toLowerCase().indexOf(value.toLowerCase()) >= 0) {
						found = 'true';
					}
				});
				if (found=='true') {
					$(this).show();
				}
				else {
					$(this).hide();
				}
			});
		}
	});
</script>


<%= form_tag(events_path, metnod: :get) do %>
  <%= text_field_tag :term %>
  <%= submit_tag 'Search' %>
<% end %>

<table id="myTable">
	<table border = "1" cellpadding = "5" cellspacing = "5" width = "800" height = "80">
	<tr class="header">
		<th style = "background-color: grey">Title</th>
		<th style = "background-color: grey">ID</th>
		<th style = "background-color: grey">Date</th>
		<th style = "background-color: grey">Hosts</th>
		<th style = "background-color: grey">Number of Attendees</th>
		<th style = "background-color: grey">Attendees</th>
		
	</tr>

	<% @events.each do |event| %>
		<tr> 
			<td> <%=event.title %></td>
			<td> <%= event.eventid %></td>
			<td> <%= event.created_at.strftime("%B %d, %Y") %></td>
			<% event.hosts.each do |host| %>
				<td><%= link_to host.hostid, host_path(host) %></td>
			<% end %>
			<td> <%= event.attendees.count %></td>
			<td><%= link_to 'Show Details', event_path(event) %></td>
		</tr>
	 <% end %> 
</table>